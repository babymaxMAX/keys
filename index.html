<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>LsJ VPN ‚Äî –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="theme-color" content="#111111">
  <style>
    :root{--bg-1:#0b0b0f;--bg-2:#101218;--brand:#f7c23e;--brand-2:#ff9900;--text:#e9edf3;--muted:#a7adba;--card:#141825;--glow:rgba(247,194,62,0.25);--line:rgba(255,255,255,0.12)}
    html,body{height:100%}
    body{margin:0;color:var(--text);background:radial-gradient(1200px 800px at 70% -10%,#1c2135 0%,transparent 70%),radial-gradient(900px 700px at 0% 100%,#1b1626 0%,transparent 65%),linear-gradient(180deg,var(--bg-1),var(--bg-2));font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial,"Helvetica Neue","Segoe UI Emoji")}
    .shell{max-width:880px;margin:0 auto;padding:28px 18px 40px}
    .card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border:1px solid var(--line);border-radius:18px;padding:22px 18px;box-shadow:0 10px 35px rgba(0,0,0,0.45),0 0 80px 0 var(--glow);backdrop-filter:blur(6px)}
    .brand{display:flex;align-items:center;gap:16px;margin:10px 0 16px}
    .logo{width:64px;height:64px;border-radius:50%;display:grid;place-items:center;flex:0 0 64px;background:radial-gradient(circle at 50% 40%,var(--brand) 0%,var(--brand-2) 60%,#a96700 100%);box-shadow:0 0 30px var(--glow),0 8px 24px rgba(0,0,0,0.45)}
    .title{font-weight:900;font-size:28px;letter-spacing:.2px}
    .sub{color:var(--muted);margin-top:2px}
    .hr{height:1px;background:var(--line);margin:18px 0}
    .h2{font-size:18px;font-weight:800;margin:14px 0 10px}
    p{margin:8px 0 10px}
    .muted{color:var(--muted)}
    .grid2{display:grid;grid-template-columns:1fr;gap:12px}
    @media (min-width:640px){.grid2{grid-template-columns:1fr 1fr}}
    .btn{-webkit-tap-highlight-color:rgba(0,0,0,0);appearance:none;border:none;cursor:pointer;text-decoration:none;display:inline-flex;align-items:center;justify-content:center;gap:10px;font-weight:800;font-size:16px;letter-spacing:.2px;border-radius:14px;padding:14px 16px;min-height:54px;width:100%;color:#101015;transition:transform .08s ease,box-shadow .14s ease,filter .14s ease;pointer-events:auto;position:relative;z-index:1}
    .btn:active{transform:translateY(1px) scale(.995)}
    .btn-primary{background:linear-gradient(180deg,var(--brand) 0%,var(--brand-2) 86%);box-shadow:0 14px 36px rgba(247,194,62,0.28),0 2px 0 rgba(255,255,255,0.18) inset}
    .btn-ghost{color:var(--text);background:linear-gradient(180deg,rgba(255,255,255,0.06),rgba(255,255,255,0.03));border:1px solid var(--line);box-shadow:0 8px 24px rgba(0,0,0,0.35)}
    .btn-store{background:linear-gradient(180deg,#1e2435,#151a28);color:#e7ebf5;border:1px solid var(--line)}
    .note{font-size:13px;color:var(--muted)}
    .toast{position:fixed;left:50%;bottom:24px;transform:translateX(-50%) translateY(30px);background:#0f1220;color:var(--text);border:1px solid var(--line);padding:10px 14px;border-radius:10px;opacity:0;transition:.22s ease;pointer-events:none;box-shadow:0 10px 30px rgba(0,0,0,0.55);font-size:14px}
    .toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
    .hid{display:none}
  </style>
</head>
<body>
  <div class="shell">
    <div class="brand">
      <div class="logo" aria-hidden="true">
        <svg width="34" height="34" viewBox="0 0 24 24" fill="#111"><path d="M12 2l.894 2.763h2.905l-2.351 1.708.897 2.762L12 7.525 9.655 9.233l.897-2.762L8.2 4.763h2.905L12 2z"/></svg>
      </div>
      <div>
        <div class="title">LsJ VPN</div>
        <div class="sub">Comrades ‚Ä¢ Premium Access</div>
      </div>
    </div>

    <div class="card">
      <div style="font-size:18px;font-weight:800;margin-bottom:6px">üíª LsJ VPN –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ</div>

      <div class="hr"></div>

      <div class="h2">1Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ v2raytun</div>
      <div class="grid2">
        <a class="btn btn-store" href="https://apps.apple.com/ru/app/v2raytun/id6476628951" target="_blank" rel="noopener">Ô£ø macOS / MacBook</a>
        <a class="btn btn-store" href="https://apps.apple.com/ru/app/v2raytun/id6476628951?l=en-GB" target="_blank" rel="noopener">Ô£ø iPhone / iOS</a>
        <a class="btn btn-store" href="https://play.google.com/store/apps/details?id=com.v2raytun.android&hl=ru" target="_blank" rel="noopener">ü§ñ Android</a>
        <a class="btn btn-store" href="https://storage.v2raytun.com/v2RayTun_Setup.exe" target="_blank" rel="noopener">ü™ü Windows</a>
      </div>

      <div class="h2" style="margin-top:16px">2Ô∏è‚É£ –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫–ª—é—á</div>
      <div class="grid2">
        <a id="btnIOS" class="btn btn-primary" href="#" target="_self" rel="noopener">üöÄ –ü–æ–¥–∫–ª—é—á–∏—Ç—å VPN iPhone / Mac</a>
        <a id="btnAndroid" class="btn btn-ghost" href="#" target="_self" rel="noopener">‚ö° –ü–æ–¥–∫–ª—é—á–∏—Ç—å VPN Android / Windows</a>
      </div>

      <div class="grid2" style="margin-top:12px">
        <button id="btnCopy" class="btn btn-ghost" type="button">üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á</button>
      </div>

      <div class="h2" style="margin-top:16px">3Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏—Ç–µ v2raytun</div>
      <p>–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –Ω–∞–∂–º–∏—Ç–µ –±–æ–ª—å—à—É—é —Å–∏–Ω—é—é –∫–Ω–æ–ø–∫—É.</p>
    </div>
  </div>

  <div id="toast" class="toast">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ</div>

  <script>
    const ua = navigator.userAgent || "";
    const isInApp = /WhatsApp|FBAN|FBAV|Instagram|Line|VKClient|Telegram/i.test(ua);

    const qs = new URLSearchParams(location.search);
    const id = parseInt(qs.get('id'), 10);

    const btnIOS = document.getElementById('btnIOS');
    const btnAndroid = document.getElementById('btnAndroid');
    const btnCopy = document.getElementById('btnCopy');
    const toast = document.getElementById('toast');

    if (!Number.isFinite(id) || id < 1) {
      btnIOS.classList.add('hid');
      btnAndroid.classList.add('hid');
      btnCopy.classList.add('hid');
    }

    function showToast(msg){
      toast.textContent = msg;
      toast.classList.add('show');
      setTimeout(()=>toast.classList.remove('show'), 1300);
    }

    // –ï–¥–∏–Ω—ã–π deeplink —á–µ—Ä–µ–∑ –º–æ—Å—Ç + —Ä–µ–∑–µ—Ä–≤
    const originUrl = location.origin;
    const configUrl = `${originUrl}/config.html?id=${id}`;
    const bridgeUrl = `https://deeplink.website/?url=${encodeURIComponent(configUrl)}`;
    const appStore = 'https://apps.apple.com/ru/app/v2raytun/id6476628951';

    // –ö–Ω–æ–ø–∫–∏ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã —Å—Ä–∞–∑—É
    btnIOS.href = bridgeUrl;
    btnAndroid.href = bridgeUrl;

    function openDeeplink() {
      let attempts = 0;
      const maxAttempts = 3;

      function attempt() {
        attempts++;
        try {
          if (attempts === 1) {
            window.location.href = bridgeUrl;
          } else if (attempts === 2) {
            const a = document.createElement('a');
            a.href = bridgeUrl; a.style.display = 'none';
            document.body.appendChild(a); a.click(); a.remove();
          } else {
            window.open(bridgeUrl, '_blank', 'noopener');
          }
        } catch(_) {}

        if (attempts >= maxAttempts) {
          copyConfig();
        } else {
          setTimeout(attempt, 200);
        }
      }

      setTimeout(attempt, 100);
    }

    btnIOS.addEventListener('click',(e)=>{
      if (isInApp) {
        e.preventDefault();
        alert('–û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ Safari: –Ω–∞–∂–º–∏—Ç–µ ‚Ä¢‚Ä¢‚Ä¢ –∏–ª–∏ Aa ‚Üí ¬´–û—Ç–∫—Ä—ã—Ç—å –≤ Safari¬ª, –∑–∞—Ç–µ–º —Å–Ω–æ–≤–∞ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É.');
        return;
      }
      openDeeplink();
      setTimeout(()=>{ try{ location.href = appStore; }catch(_){} }, 900);
    }, { passive: false });

    btnAndroid.addEventListener('click', ()=>{
      openDeeplink();
    }, { passive: true });

    async function copyConfig(){
      try{
        const r = await fetch(configUrl, { cache:'no-store' });
        if(!r.ok) throw new Error('cfg');
        const text = (await r.text()).trim();
        try{
          await navigator.clipboard.writeText(text);
        }catch{
          const ta=document.createElement('textarea'); ta.value=text; document.body.appendChild(ta);
          ta.select(); document.execCommand('copy'); ta.remove();
        }
        showToast('–ö–ª—é—á —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω');
      }catch(_){}
    }

    btnCopy.addEventListener('click', copyConfig, { passive:true });
  </script>
</body>
</html>
